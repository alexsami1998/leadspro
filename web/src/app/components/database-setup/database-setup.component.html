<div class="database-setup-container">
  <div class="setup-card">
    <div class="setup-header">
      <h2>üîß Configura√ß√£o do Banco de Dados</h2>
      <p>Configure a conex√£o com o PostgreSQL para o sistema LeadPro</p>
    </div>

    <form class="setup-form" (ngSubmit)="initializeDatabase()">
      <!-- Configura√ß√µes B√°sicas -->
      <div class="form-section">
        <h3>Configura√ß√µes de Conex√£o</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="host">Host</label>
            <input
              type="text"
              id="host"
              name="host"
              [(ngModel)]="config.host"
              placeholder="localhost"
              required
              class="form-input"
            />
          </div>

          <div class="form-group">
            <label for="port">Porta</label>
            <input
              type="number"
              id="port"
              name="port"
              [(ngModel)]="config.port"
              placeholder="5432"
              min="1"
              max="65535"
              required
              class="form-input"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="database">Nome do Banco</label>
          <input
            type="text"
            id="database"
            name="database"
            [(ngModel)]="config.database"
            placeholder="leadpro"
            required
            class="form-input"
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="username">Usu√°rio</label>
            <input
              type="text"
              id="username"
              name="username"
              [(ngModel)]="config.username"
              placeholder="postgres"
              required
              class="form-input"
            />
          </div>

          <div class="form-group">
            <label for="password">Senha</label>
            <input
              type="password"
              id="password"
              name="password"
              [(ngModel)]="config.password"
              placeholder="Digite a senha"
              required
              class="form-input"
            />
          </div>
        </div>
      </div>

      <!-- Configura√ß√µes Avan√ßadas -->
      <div class="form-section" *ngIf="showAdvanced">
        <h3>Configura√ß√µes Avan√ßadas</h3>
        <div class="form-group">
          <label>String de Conex√£o</label>
          <div class="connection-string">
            <code>{{ getConnectionString() }}</code>
            <button type="button" class="copy-button" (click)="navigator.clipboard.writeText(getConnectionString())">
              üìã Copiar
            </button>
          </div>
        </div>
      </div>

      <!-- Mensagens de Erro/Sucesso -->
      <div class="message-container" *ngIf="errorMessage || successMessage">
        <div class="error-message" *ngIf="errorMessage">
          ‚ùå {{ errorMessage }}
        </div>
        <div class="success-message" *ngIf="successMessage">
          ‚úÖ {{ successMessage }}
        </div>
      </div>

      <!-- A√ß√µes -->
      <div class="actions">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="useDefaultConfig()"
          [disabled]="loading || testing"
        >
          üîÑ Usar Configura√ß√£o Padr√£o
        </button>

        <button
          type="button"
          class="btn btn-outline"
          (click)="toggleAdvanced()"
          [disabled]="loading || testing"
        >
          {{ showAdvanced ? 'üîΩ' : 'üîº' }} Configura√ß√µes Avan√ßadas
        </button>

        <button
          type="button"
          class="btn btn-test"
          (click)="testConnection()"
          [disabled]="loading || testing"
        >
          <span *ngIf="!testing">üîç Testar Conex√£o</span>
          <span *ngIf="testing" class="loading-spinner"></span>
        </button>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="loading || testing"
        >
          <span *ngIf="!loading">üöÄ Inicializar Banco</span>
          <span *ngIf="loading" class="loading-spinner"></span>
        </button>
      </div>
    </form>

    <!-- Informa√ß√µes de Ajuda -->
    <div class="help-section">
      <h4>üìö Informa√ß√µes de Ajuda</h4>
      <div class="help-content">
        <div class="help-item">
          <strong>Configura√ß√£o Padr√£o:</strong>
          <ul>
            <li>Host: localhost</li>
            <li>Porta: 5432</li>
            <li>Banco: leadpro</li>
            <li>Usu√°rio: postgres</li>
          </ul>
        </div>
        
        <div class="help-item">
          <strong>Requisitos:</strong>
          <ul>
            <li>PostgreSQL instalado e rodando</li>
            <li>Banco de dados 'leadpro' criado</li>
            <li>Usu√°rio com permiss√µes de cria√ß√£o de tabelas</li>
          </ul>
        </div>

        <div class="help-item">
          <strong>Comandos SQL para criar o banco:</strong>
          <code>
            CREATE DATABASE leadpro;<br>
            CREATE USER leadpro_user WITH PASSWORD 'sua_senha';<br>
            GRANT ALL PRIVILEGES ON DATABASE leadpro TO leadpro_user;
          </code>
        </div>
      </div>
    </div>
  </div>
</div>
