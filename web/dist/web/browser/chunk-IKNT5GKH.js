import{f as u}from"./chunk-STUYBPRI.js";import{L as o,O as b,Pb as p,T as d,d as l,m as c,n as r,q as h,y as a}from"./chunk-W5YSIOEO.js";var g=class i{constructor(e){this.http=e}CONFIG_KEY="leadpro_db_config";CHECKED_DATABASES_KEY="leadpro_checked_databases";apiUrl=u.apiUrl;getDatabaseConfig(){let e=localStorage.getItem(this.CONFIG_KEY);return e?JSON.parse(e):null}setDatabaseConfig(e){localStorage.setItem(this.CONFIG_KEY,JSON.stringify(e))}getCheckedDatabases(){let e=localStorage.getItem(this.CHECKED_DATABASES_KEY);return e?JSON.parse(e):[]}setCheckedDatabase(e){let t=this.getCheckedDatabases();t.includes(e)||(t.push(e),localStorage.setItem(this.CHECKED_DATABASES_KEY,JSON.stringify(t)))}createConnectionString(e){return`${e.host}:${e.port}/${e.database}`}initializeDatabase(e){return l(this,null,function*(){try{this.setDatabaseConfig(e);let t=this.createConnectionString(e);if(this.getCheckedDatabases().includes(t))return console.log("Banco de dados j\xE1 verificado anteriormente"),!0;let n=yield this.http.post(`${this.apiUrl}/database/init`,e).toPromise();if(n?.success)return this.setCheckedDatabase(t),console.log("Banco de dados inicializado com sucesso"),!0;throw new Error(n?.message||"Erro ao inicializar banco de dados")}catch(t){throw console.error("Erro ao inicializar banco de dados:",t),t}})}getLeads(){return this.http.get(`${this.apiUrl}/leads`).pipe(o(e=>console.log("Leads carregados:",e)),a(e=>(console.error("Erro ao carregar leads:",e),r(()=>e))))}getLead(e){return this.http.get(`${this.apiUrl}/leads/${e}`).pipe(a(t=>(console.error(`Erro ao carregar lead ${e}:`,t),r(()=>t))))}createLead(e){return this.http.post(`${this.apiUrl}/leads`,e).pipe(o(t=>console.log("Lead criado:",t)),a(t=>(console.error("Erro ao criar lead:",t),r(()=>t))))}updateLead(e,t){return this.http.put(`${this.apiUrl}/leads/${e}`,t).pipe(o(s=>console.log("Lead atualizado:",s)),a(s=>(console.error(`Erro ao atualizar lead ${e}:`,s),r(()=>s))))}deleteLead(e){return this.http.delete(`${this.apiUrl}/leads/${e}`).pipe(o(()=>console.log(`Lead ${e} exclu\xEDdo`)),a(t=>(console.error(`Erro ao excluir lead ${e}:`,t),r(()=>t))))}getInteractions(e){return this.http.get(`${this.apiUrl}/leads/${e}/interactions`)}createInteraction(e){return this.http.post(`${this.apiUrl}/interactions`,e)}getUsers(){return this.http.get(`${this.apiUrl}/users`)}createUser(e){return this.http.post(`${this.apiUrl}/users`,e)}updateUser(e,t){return this.http.put(`${this.apiUrl}/users/${e}`,t)}deleteUser(e){return this.http.delete(`${this.apiUrl}/users/${e}`)}getWebhooks(){return this.http.get(`${this.apiUrl}/webhooks`)}createWebhook(e){return this.http.post(`${this.apiUrl}/webhooks`,e)}updateWebhook(e,t){return this.http.put(`${this.apiUrl}/webhooks/${e}`,t)}deleteWebhook(e){return this.http.delete(`${this.apiUrl}/webhooks/${e}`)}getDashboardStats(){return this.http.get(`${this.apiUrl}/dashboard/stats`)}testConnection(e){return this.http.post(`${this.apiUrl}/database/test`,e).pipe(h(t=>t.success),a(()=>c(!1)))}static \u0275fac=function(t){return new(t||i)(d(p))};static \u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})};export{g as a};
