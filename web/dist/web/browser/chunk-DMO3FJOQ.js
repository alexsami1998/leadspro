import{c as O}from"./chunk-UIM3EO6U.js";import{Ea as _,Eb as D,Fb as M,Hb as S,Ja as c,Kb as y,Ma as m,Pa as n,Pb as F,Qa as i,Ra as x,Ta as b,U as d,Ua as C,Y as f,Ya as r,Za as u,_a as v,db as E,fb as I,hb as L,ua as h,xa as l}from"./chunk-W5YSIOEO.js";function k(a,t){if(a&1&&(n(0,"a",6),r(1,"WhatsApp"),i()),a&2){let e=C();m("href",e.waLink(),h)}}function $(a,t){if(a&1&&(n(0,"li")(1,"strong"),r(2),I(3,"date"),i(),r(4),i()),a&2){let e=t.$implicit;l(2),u(L(3,2,e.createdAt,"short")),l(2),v(" \u2014 ",e.content," ")}}var T=class a{http=d(F);route=d(O);lead=_(null);waLink(){let t=this.lead();if(!t?.phone)return"#";let e=encodeURIComponent(`Ol\xE1 ${t.name}, tudo bem?`);return`https://wa.me/${t.phone.replace(/\D/g,"")}?text=${e}`}load(){let t=this.route.snapshot.paramMap.get("id");this.http.get(`/api/leads/${t}`).subscribe(e=>this.lead.set(e))}addInteraction(t){t.preventDefault();let e=t.target,o=e.elements.namedItem("content").value.trim();if(!o)return;let s=this.route.snapshot.paramMap.get("id");this.http.post(`/api/interactions/${s}`,{content:o}).subscribe(()=>{e.reset(),this.load()})}constructor(){this.load()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=f({type:a,selectors:[["app-lead-detail"]],standalone:!0,features:[E],decls:14,vars:3,consts:[["routerLink","/leads"],[1,"actions"],["target","_blank",3,"href",4,"ngIf"],[3,"submit"],["name","content","placeholder","Registrar intera\xE7\xE3o"],[4,"ngFor","ngForOf"],["target","_blank",3,"href"]],template:function(e,o){if(e&1&&(n(0,"button",0),r(1,"\u2190 Voltar"),i(),n(2,"h1"),r(3),i(),n(4,"div",1),c(5,k,2,1,"a",2),i(),n(6,"h3"),r(7,"Timeline"),i(),n(8,"form",3),b("submit",function(p){return o.addInteraction(p)}),x(9,"input",4),n(10,"button"),r(11,"Adicionar"),i()(),n(12,"ul"),c(13,$,5,5,"li",5),i()),e&2){let s,p,g;l(3),u((s=o.lead())==null?null:s.name),l(2),m("ngIf",(p=o.lead())==null?null:p.phone),l(8),m("ngForOf",(g=o.lead())==null?null:g.interactions)}},dependencies:[y,D,M,S],styles:[".actions[_ngcontent-%COMP%]{margin:8px 0}.actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background:#22c55e26;padding:8px 12px;border-radius:8px;text-decoration:none}"]})};export{T as LeadDetailComponent};
