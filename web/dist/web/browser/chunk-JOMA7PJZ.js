import{L as i,O as d,S as u,Ub as g,ac as $,d as c,n as l,o as a,r as p,z as s}from"./chunk-G7TP3EBD.js";var f=(()=>{let r=class r{constructor(t){this.http=t,this.CONFIG_KEY="leadpro_db_config",this.CHECKED_DATABASES_KEY="leadpro_checked_databases",this.apiUrl=$.apiUrl}getDatabaseConfig(){let t=localStorage.getItem(this.CONFIG_KEY);return t?JSON.parse(t):null}setDatabaseConfig(t){localStorage.setItem(this.CONFIG_KEY,JSON.stringify(t))}getCheckedDatabases(){let t=localStorage.getItem(this.CHECKED_DATABASES_KEY);return t?JSON.parse(t):[]}setCheckedDatabase(t){let e=this.getCheckedDatabases();e.includes(t)||(e.push(t),localStorage.setItem(this.CHECKED_DATABASES_KEY,JSON.stringify(e)))}createConnectionString(t){return`${t.host}:${t.port}/${t.database}`}initializeDatabase(t){return c(this,null,function*(){try{this.setDatabaseConfig(t);let e=this.createConnectionString(t);if(this.getCheckedDatabases().includes(e))return console.log("Banco de dados j\xE1 verificado anteriormente"),!0;let h=yield this.http.post(`${this.apiUrl}/database/init`,t).toPromise();if(h?.success)return this.setCheckedDatabase(e),console.log("Banco de dados inicializado com sucesso"),!0;throw new Error(h?.message||"Erro ao inicializar banco de dados")}catch(e){throw console.error("Erro ao inicializar banco de dados:",e),e}})}getLeads(){return this.http.get(`${this.apiUrl}/leads`).pipe(i(t=>console.log("Leads carregados:",t)),s(t=>(console.error("Erro ao carregar leads:",t),a(()=>t))))}getLead(t){return this.http.get(`${this.apiUrl}/leads/${t}`).pipe(s(e=>(console.error(`Erro ao carregar lead ${t}:`,e),a(()=>e))))}createLead(t){return this.http.post(`${this.apiUrl}/leads`,t).pipe(i(e=>console.log("Lead criado:",e)),s(e=>(console.error("Erro ao criar lead:",e),a(()=>e))))}updateLead(t,e){return this.http.put(`${this.apiUrl}/leads/${t}`,e).pipe(i(o=>console.log("Lead atualizado:",o)),s(o=>(console.error(`Erro ao atualizar lead ${t}:`,o),a(()=>o))))}deleteLead(t){return this.http.delete(`${this.apiUrl}/leads/${t}`).pipe(i(()=>console.log(`Lead ${t} exclu\xEDdo`)),s(e=>(console.error(`Erro ao excluir lead ${t}:`,e),a(()=>e))))}getInteractions(t){return this.http.get(`${this.apiUrl}/leads/${t}/interactions`)}createInteraction(t){return this.http.post(`${this.apiUrl}/interactions`,t)}getUsers(){return this.http.get(`${this.apiUrl}/users`)}createUser(t){return this.http.post(`${this.apiUrl}/users`,t)}updateUser(t,e){return this.http.put(`${this.apiUrl}/users/${t}`,e)}deleteUser(t){return this.http.delete(`${this.apiUrl}/users/${t}`)}getWebhooks(){return this.http.get(`${this.apiUrl}/webhooks`)}createWebhook(t){return this.http.post(`${this.apiUrl}/webhooks`,t)}updateWebhook(t,e){return this.http.put(`${this.apiUrl}/webhooks/${t}`,e)}deleteWebhook(t){return this.http.delete(`${this.apiUrl}/webhooks/${t}`)}getDashboardStats(){return this.http.get(`${this.apiUrl}/dashboard/stats`)}testConnection(t){return this.http.post(`${this.apiUrl}/database/test`,t).pipe(p(e=>e.success),s(()=>l(!1)))}};r.\u0275fac=function(e){return new(e||r)(u(g))},r.\u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();export{f as a};
